<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl"?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
	"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" [

<!ENTITY % growlightents SYSTEM "growlight.ent" >
%growlightents;

<!-- TITLE should be something like "User commands",		-->
<!-- "&dhpackage; command-line reference" or similar (see e.g.	-->
<!-- http://www.tldp.org/HOWTO/Man-Page/q2.html). But limit	-->
<!-- it to 30    "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" chars.	-->
<!ENTITY dhtitle "growlight reference">
  
<!-- This is the application/package name.	-->
<!ENTITY dhucpackage "growlight">
<!ENTITY dhpackage "growlight">

<!-- If the application e.g. belongs to a package like X.org,	-->
<!-- this should be set to the package/suite name instead of	-->
<!-- dhpackage.							-->
<!ENTITY dhproduct "growlight">

<!-- SECTION should be 1-8, maybe w/ subsection other	-->
<!-- parameters are allowed: see man(7), man(1) and	-->
<!-- http://www.tldp.org/HOWTO/Man-Page/q2.html.	-->
<!ENTITY dhsection "8">

]>

<refentry>
	<refentryinfo>
		<title>&dhtitle;</title>
		<!-- Better put a suite name instead of &dhpackage; into productname -->
		<productname>&dhproduct;</productname>
		<releaseinfo role="version">&dhrelease;</releaseinfo>
		<authorgroup>
			<author>
				<firstname>&dhfirstname;</firstname>
				<surname>&dhsurname;</surname>
				<contrib>Design and implementation.</contrib>
				<address>
					<email>&dhemail;</email>
				</address>
			</author>
		</authorgroup>
		<copyright>
			<year>2012</year>
			<holder>&dhusername;</holder>
		</copyright>
	</refentryinfo>
	<refmeta>
		<refentrytitle>&dhucpackage;</refentrytitle>
		<manvolnum>&dhsection;</manvolnum>
	</refmeta>
	<refnamediv>
		<refname>&dhpackage;</refname>
		<refpurpose>System disk preparation</refpurpose>
	</refnamediv>
	<refsynopsisdiv>
		<cmdsynopsis>
			<command>&dhpackage;</command>
			<arg>-h|--help</arg>
			<arg>-t|--target path</arg>
			<arg>-v|--verbose</arg>
			<arg>-V|--version</arg>
		</cmdsynopsis>
	</refsynopsisdiv>
	<refsect1 id="description">
		<title>DESCRIPTION</title>
		<para><command>&dhpackage;</command> detects and describes
                disk pools, block devices, partition tables, and partitions.
		It can partition devices, manipulate ZFS, MDADM, DMRAID, LVM
		and hardware RAID virtual devices, and prepare an fstab file
		for using the devices to boot or in a chroot, and is fully
		aware of variable sector sizes, GPT, and UEFI.</para>
	</refsect1>
	<refsect1 id="options">
		<title>OPTIONS</title>
		<varlistentry>
			<term><option>-h|--help</option></term>
			<listitem>
			<para>Print a brief usage summary and exit.</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>-v|--verbose</option></term>
			<listitem>
			<para>Be more verbose.</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>-V|--version</option></term>
			<listitem>
			<para>Print version information and exit.</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>-t|--target path</option></term>
			<listitem>
<para>Run in system installation mode, using path as the temporary mountpoint
for the target's root filesystem. "map" commands will populate the hierarchy
rooted at this mountpoint. System installation mode can also be entered at run
time with the "target" command. The "map" command will not result in active
mounts unless growlight is operating in system installation mode (they will
merely be used to construct target fstab output). Once system installation mode
is entered, growlight will return 0 only as a result of a successful invocation
of the "finalize" command. The target path needn't exist at specification time,
but it must exist before any maps can be defined.</para>
			</listitem>
		</varlistentry>
	</refsect1>
	<refsect1 id="commands">
		<title>COMMANDS</title>
		<variablelist>
		<varlistentry>
			<term><option>uefiboot</option></term>
			<listitem>
<para>Prepare the target for UEFI-based booting. A target root filesystem map
must be defined, and this filesystem must be mounted at the chroot's toplevel.
The filesystem must reside within a GPT partition having type ef00 and TUID
C12A7328-F81F-11D2-BA4B-00A0C93EC93B (EFI System Partition). This GPT
table must not reside on an mdadm, device-mapper, or zfs device. Preferably, no
other devices in the system are bootable, but this is not enforced.

If all these conditions are met, rEFInd will be installed into this filesystem,
configured to boot a Linux kernel residing at FIXME. This kernel must be
compiled with EFI stub loader support. The bootloader portion of the device's
MBR will be overwritten with zeroes, if possible, to deter attempting to
perform a BIOS/MBR boot from the device.</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>biosboot</option></term>
			<listitem>
<para>Prepare the target for BIOS-based booting. A target root filesystem map
must be defined, and this filesystem must be mounted at the chroot's toplevel.
The filesystem must reside either within a GPT partition having type ef02 and
TUID 21686148-6449-6E6F-744E-656564454649 (BIOS Boot Partition), or within a
MBR partition having type 0x83 (Linux). The partition table must not reside
on an mdadm, device-mapper, or zfs device. Preferably, no other devices in the
system are bootable, but this is not enforced.

If all these conditions are met, GRUB2 will be installed into this filesystem
at /boot/grub, configured to boot a Linux kernel residing at FIXME. GRUB2's
first stage will be loaded into the bootloader portion of the device's MBR. The
partition containing GRUB2 will be marked as <emphasis role="bold">active</emphasis>
(flag 0x80).</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>adapter</option></term>
		</varlistentry>
		<varlistentry>
			<term><option>blockdev</option></term>
		</varlistentry>
		<varlistentry>
			<term><option>partition</option></term>
		</varlistentry>
		<varlistentry>
			<term><option>fs</option></term>
		</varlistentry>
		<varlistentry>
			<term><option>swap</option></term>
		</varlistentry>
		<varlistentry>
			<term><option>mdadm [ -v | arguments ]</option></term>
			<listitem>
<para>Passed no arguments, <emphasis role="bold">mdadm</emphasis> concisely lists
each MD (Multiple Device, aka the Linux kernel's mdraid driver) device
currently available to the system. Passed "-v", each MD device's components
will also be listed. Otherwise, arguments will be sanitized and passed to the
external <emphasis role="bold">mdadm(8)</emphasis> tool. Note that this
behavior is subject to change as MD is more fully integrated.</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>dmsetup [ arguments ]</option></term>
			<listitem>
<para>Arguments are sanitized and passed to the external
<emphasis role="bold">dmsetup(8)</emphasis> tool. Note that this behavior is
subject to change as DM is more fully integrated.</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>zpool [ -v | arguments ]</option></term>
			<listitem>
<para>Passed no arguments, <emphasis role="bold">zpool</emphasis> concisely lists
each zpool (ZFS storage pool) device currently available to the system. Passed
"-v", each zpool's components will also be listed. Otherwise, arguments will be
sanitized and passed to the external <emphasis role="bold">zpool(8)</emphasis>
tool. Note that this behavior is subject to change as ZFS is more fully
integrated.</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>zfs [ arguments ]</option></term>
			<listitem>
<para>Arguments are sanitized and passed to the external
<emphasis role="bold">zfs(8)</emphasis> tool. This command is not expected to
be retained once ZFS is fully integrated.</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>target [ "set" path | "unset" ]</option></term>
			<listitem>
<para>Called with "set", sets the target (see the <emphasis role="bold">--target</emphasis>
option). If a target has already been set, the command will fail. If the path
does not exist in the current filesystem, the command will fail. If the path
exists, but is not a directory, the command will fail. Called with "unset",
undefines the target and all mappings therein. If there is no target defined,
the command will fail. Called with no arguments, lists the current target (if
one exists).</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>map</option></term>
		</varlistentry>
		<varlistentry>
			<term><option>mounts</option></term>
		</varlistentry>
		<varlistentry>
			<term><option>grubmap</option></term>
			<listitem>
<para>Invokes <emphasis role="bold">grub-mkdevicemap</emphasis> to display
GRUB's calculated device map. This will not overwrite any existing device
map, but is included merely for diagnostic purposes. Accepts no arguments.</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>rescan</option></term>
		</varlistentry>
		<varlistentry>
			<term><option>benchmark</option></term>
		</varlistentry>
		<varlistentry>
			<term><option>troubleshoot</option></term>
		</varlistentry>
		<varlistentry>
			<term><option>version</option></term>
			<listitem>
<para>Displays the growlight banner and version, and the version of various
	tools/libraries. <emphasis role="bold">version</emphasis> accepts no arguments.</para>
			</listitem>
		</varlistentry>
		<varlistentry>
			<term><option>help</option></term>
		</varlistentry>
		<varlistentry>
			<term><option>quit</option></term>
			<listitem>
<para>Exits the program. See the <emphasis role="bold">--target</emphasis>
command line option and <emphasis role="bold">target</emphasis> command to
understand the conditions for a successful return during installation mode.
<emphasis role="bold">quit</emphasis> accepts no arguments.</para>
			</listitem>
		</varlistentry>
		</variablelist>
	</refsect1>
	<refsect1 id="bugs">
		<title>BUGS</title>
		<para>Search <ulink url="http://www.sprezzatech.com/bugs/buglist.cgi?component=Growlight"/>.
		Mail bug reports and/or patches to the authors.</para>
	</refsect1>
	<refsect1 id="see_also">
		<title>SEE ALSO</title>
		<para>GitHub: <ulink url="http://github.com/dankamongmen/growlight"/></para>
		<para>Project wiki: <ulink url="http://dank.qemfd.net/dankwiki/index.php/growlight"/></para>
		<para>
		<citerefentry>
			<refentrytitle>blkid</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>dmraid</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>dmsetup</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>fstab</refentrytitle>
			<manvolnum>5</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>grub-install</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>hdparm</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>libblkid</refentrytitle>
			<manvolnum>3</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>lsblk</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>mdadm</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>parted</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>sfdisk</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>sgdisk</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>zfs</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>, <citerefentry>
			<refentrytitle>zpool</refentrytitle>
			<manvolnum>8</manvolnum>
		</citerefentry>
		</para>
	</refsect1>
</refentry>
